(()=>{var t={n:e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};(()=>{"use strict";function e(t,n){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},e(t,n)}const n=flarum.core.compat["common/extend"],o=flarum.core.compat["forum/app"];var r=t.n(o);const a=flarum.core.compat["common/components/Button"];var s=t.n(a);const i=flarum.core.compat["common/components/Modal"];var c=t.n(i);const l=flarum.core.compat["forum/components/DiscussionPage"];var u=t.n(l),d=function(t){function n(){return t.apply(this,arguments)||this}var o,a;a=t,(o=n).prototype=Object.create(a.prototype),o.prototype.constructor=o,e(o,a);var i=n.prototype;return i.oninit=function(e){t.prototype.oninit.call(this,e),this.linkUrl=this.attrs.linkUrl,this.warningText=this.attrs.warningText},i.title=function(){return r().translator.trans("wszdb-shareurl.forum.link_warning_title")},i.className=function(){return"LinkWarningModal"},i.content=function(){var t=this;return m("div",{className:"Modal-body"},m("p",null,this.warningText),m("div",{className:"Modal-footer",style:{justifyContent:"flex-start",marginTop:"20px"}},m(s(),{className:"Button Button--primary",onclick:function(){return t.hide()}},r().translator.trans("wszdb-shareurl.forum.cancel_button")),m("span",{style:{margin:"0 20px"}},"Â "),m(s(),{className:"Button Button--primary",onclick:function(){window.open(t.linkUrl,"_blank"),t.hide()}},r().translator.trans("wszdb-shareurl.forum.confirm_button"))))},n}(c());function p(){var t=r().translator.trans("wszdb-shareurl.forum.copy_success"),e=document.createElement("div");e.className="Alert Alert--success",e.style.position="fixed",e.style.bottom="20px",e.style.left="20px",e.style.zIndex="9999";var n=document.createElement("span");n.innerHTML="ðŸ”— ",n.style.marginRight="8px",e.appendChild(n),e.appendChild(document.createTextNode(t)),document.body.appendChild(e),setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},2e3)}function f(t){var e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy"),p()}catch(t){var n=r().translator.trans("wszdb-shareurl.forum.copy_failed"),o=document.createElement("div");o.className="Alert Alert--error",o.style.position="fixed",o.style.bottom="20px",o.style.left="20px",o.style.zIndex="9999",o.textContent=n,document.body.appendChild(o),setTimeout(function(){o.parentNode&&o.parentNode.removeChild(o)},2e3)}document.body.removeChild(e)}r().initializers.add("wszdb-shareurl",function(){(0,n.extend)(r(),"mount",function(){document.body.addEventListener("click",function(t){var e=t.target.closest("a");if(e&&e.href){var n=window.location.hostname;if(new URL(e.href).hostname!==n&&!(r().forum.attribute("wszdb.shareurl.whitelist")||[]).some(function(t){return e.href.includes(t.trim())})){t.preventDefault(),t.stopPropagation();var o=r().forum.attribute("wszdb.shareurl.warningText")||r().translator.trans("wszdb-shareurl.forum.warning_message");return setTimeout(function(){r().modal.show(d,{linkUrl:e.href,warningText:o})},0),!1}}},{passive:!1})}),(0,n.extend)(u().prototype,"sidebarItems",function(t){var e=this;r().forum.attribute("wszdb.shareurl.enableCopyLink")&&t.add("copyLink",s().component({className:"Button Button--secondary",icon:"fas fa-link",onclick:function(){return t=e.discussion.title(),n=window.location.href,o=t+"\n"+n,void(navigator.clipboard?navigator.clipboard.writeText(o).then(function(){p()}).catch(function(){f(o)}):f(o));var t,n,o}},r().translator.trans("wszdb-shareurl.forum.copy_link_button")),10)})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map